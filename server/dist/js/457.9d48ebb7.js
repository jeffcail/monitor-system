"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[457],{8457:function(e,a,l){l.r(a),l.d(a,{default:function(){return Y}});var t=l(6810),u=l(971),d=l(366),s=l(4181),r=l(4545),n=l(7534),i=l(4195),o=l(8276),m=l(3378),p=l(6252),v=l(3577),c=l(2262),_=l(2201),g=l(842),w=l(1348),f=l(9737);const k=e=>((0,p.dD)("data-v-bc5d6c6c"),e=e(),(0,p.Cn)(),e),W={class:"addServe-info"},h=k((()=>(0,p._)("div",{class:"addServe-title",align:"left"},"添加服务检测",-1))),y=(0,p.Uk)("添加"),z={class:"serve-list"},b={style:{display:"flex","align-items":"center"}},V={style:{"margin-left":"10px"}},U={style:{display:"flex","align-items":"center"}},x={key:0,style:{"margin-left":"10px",color:"green"}},H={key:1,style:{"margin-left":"10px",color:"red"}},C=(0,p.Uk)("删除"),T=(0,p.Uk)("升级"),S={class:"demo-pagination-block"},D=(0,p.Uk)(" 服务地址: "),F=(0,p.Uk)(" 服务包名: "),I=(0,p.Uk)(" 服务路径: "),q={class:"dialog-footer"},P=(0,p.Uk)("取消升级"),$=(0,p.Uk)("开始升级");var j={__name:"serve",setup(e){const a=(0,c.iH)(!1),l=(0,c.iH)(!1),k=(0,c.iH)(!1),j=((0,_.tv)(),(0,c.iH)(!1)),B=(0,c.iH)({package_name:"",package_path:"",serve_ip:""}),R=async()=>{let e={serve_ip:B.value.serve_ip,package_name:B.value.package_name,package_path:B.value.package_path},a=await(0,g.mL)(e);a&&2e3===a.code&&(w.z8.success(a.msg),j.value=!1),N()},Y=(0,c.iH)({serve_address:"",serve_name:""}),Z=(0,c.qj)({serve_address:{required:!0,message:"请输入服务地址",trigger:"blur"},serve_name:{required:!0,message:"请输入服务名称",trigger:"blur"}}),A=(0,c.iH)(null),E=()=>{A.value.validate((async e=>{if(e){let e={serve_name:Y.value.serve_name,serve_address:Y.value.serve_address},a=await(0,g.zI)(e);2e3===a.code&&(w.z8.success("添加成功"),N())}else w.z8.warning("请填写完整")}))},K=e=>{f.T.confirm(`确定删除${e.serve_name}吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,g.SH)({id:e.id});N()})).catch((()=>{w.z8.warning("取消删除")}))},L=(0,c.iH)(0),G=(0,c.iH)([]),J=(0,c.iH)({page:1,page_size:10}),M=(0,c.iH)(),N=async()=>{clearTimeout(M.value),M.value=setTimeout((()=>N()),2e4);let e={page:J.value.page,page_size:J.value.page_size},a=await(0,g.h8)(e);2e3!==a.code&&(a.data=[]),G.value=a.data.list,L.value=a.data.total};N();const O=e=>{J.value.page_size=e,J.value.page=1,N()},Q=e=>{J.value.page=e,N()};return(0,p.Ah)((()=>{clearTimeout(M.value),clearTimeout(M.value)})),(e,c)=>{const _=m.EZ,g=i.nH,w=o.mi,f=i.ly,M=n.Ks,N=r.$t,X=d.$Y,ee=(0,p.up)("timer"),ae=s.gn,le=(0,p.up)("SuccessFilled"),te=(0,p.up)("WarningFilled"),ue=d.eI,de=u.R,se=t.d0;return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p._)("div",null,[(0,p._)("div",W,[h,(0,p.Wm)(f,{ref_key:"ruleFormRef",ref:A,model:Y.value,rules:Z,"status-icon":"","label-width":"120px",class:"demo-ruleForm"},{default:(0,p.w5)((()=>[(0,p.Wm)(g,{label:"地址",prop:"channelId"},{default:(0,p.w5)((()=>[(0,p.Wm)(_,{modelValue:Y.value.serve_address,"onUpdate:modelValue":c[0]||(c[0]=e=>Y.value.serve_address=e),style:{width:"500px"},type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,p.Wm)(g,{label:"名称",prop:"url"},{default:(0,p.w5)((()=>[(0,p.Wm)(_,{modelValue:Y.value.serve_name,"onUpdate:modelValue":c[1]||(c[1]=e=>Y.value.serve_name=e),style:{width:"500px"},type:"text",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,p.Wm)(g,null,{default:(0,p.w5)((()=>[(0,p.Wm)(w,{type:"primary",onClick:c[2]||(c[2]=e=>E())},{default:(0,p.w5)((()=>[y])),_:1})])),_:1})])),_:1},8,["model","rules"])])]),(0,p._)("div",z,[(0,p.Wm)(ue,{data:G.value,style:{width:"100%"}},{default:(0,p.w5)((()=>[(0,p.Wm)(X,{label:"名称",width:"280"},{default:(0,p.w5)((e=>[(0,p.Wm)(N,{effect:"light",trigger:"hover",placement:"top",width:"auto"},{default:(0,p.w5)((()=>[(0,p._)("div",null,(0,v.zw)(e.row.serve_address),1)])),reference:(0,p.w5)((()=>[(0,p.Wm)(M,null,{default:(0,p.w5)((()=>[(0,p.Uk)((0,v.zw)(e.row.serve_name),1)])),_:2},1024)])),_:2},1024)])),_:1}),(0,p.Wm)(X,{label:"上次检测时间",width:"280"},{default:(0,p.w5)((e=>[(0,p._)("div",b,[(0,p.Wm)(ae,null,{default:(0,p.w5)((()=>[(0,p.Wm)(ee)])),_:1}),(0,p._)("span",V,(0,v.zw)(e.row.last_check_time),1)])])),_:1}),(0,p.Wm)(X,{label:"状态",width:"280"},{default:(0,p.w5)((e=>[(0,p._)("div",U,[1==e.row.serve_state?((0,p.wg)(),(0,p.iD)("span",x,[(0,p.Wm)(ae,null,{default:(0,p.w5)((()=>[(0,p.Wm)(le)])),_:1})])):((0,p.wg)(),(0,p.iD)("span",H,[(0,p.Wm)(ae,null,{default:(0,p.w5)((()=>[(0,p.Wm)(te)])),_:1})]))])])),_:1}),(0,p.Wm)(X,{label:"操作"},{default:(0,p.w5)((({row:e})=>[(0,p.Wm)(w,{size:"small",type:"danger",onClick:a=>K(e)},{default:(0,p.w5)((()=>[C])),_:2},1032,["onClick"]),(0,p.Wm)(w,{size:"small",type:"primary",onClick:c[3]||(c[3]=e=>j.value=!0)},{default:(0,p.w5)((()=>[T])),_:1})])),_:1})])),_:1},8,["data"]),(0,p._)("div",S,[(0,p.Wm)(de,{currentPage:J.value.page,"onUpdate:currentPage":c[4]||(c[4]=e=>J.value.page=e),"page-size":J.value.page_size,"onUpdate:page-size":c[5]||(c[5]=e=>J.value.page_size=e),"page-sizes":[10,20,30,40,50],small:a.value,disabled:l.value,background:k.value,layout:"total, sizes, prev, pager, next, jumper",total:L.value,"current-page":J.value.page,onSizeChange:O,onCurrentChange:Q},null,8,["currentPage","page-size","small","disabled","background","total","current-page"])]),(0,p.Wm)(se,{modelValue:j.value,"onUpdate:modelValue":c[10]||(c[10]=e=>j.value=e),title:"升级服务",width:"30%",draggable:""},{footer:(0,p.w5)((()=>[(0,p._)("span",q,[(0,p.Wm)(w,{onClick:c[9]||(c[9]=e=>j.value=!1)},{default:(0,p.w5)((()=>[P])),_:1}),(0,p.Wm)(w,{type:"primary",onClick:R},{default:(0,p.w5)((()=>[$])),_:1})])])),default:(0,p.w5)((()=>[(0,p.Wm)(f,{model:B.value},{default:(0,p.w5)((()=>[(0,p.Wm)(g,null,{default:(0,p.w5)((()=>[D,(0,p.Wm)(_,{modelValue:B.value.serve_ip,"onUpdate:modelValue":c[6]||(c[6]=e=>B.value.serve_ip=e),placeholder:"127.0.0.1",autocomplete:"off",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,p.Wm)(g,null,{default:(0,p.w5)((()=>[F,(0,p.Wm)(_,{modelValue:B.value.package_name,"onUpdate:modelValue":c[7]||(c[7]=e=>B.value.package_name=e),autocomplete:"off",style:{width:"200px"}},null,8,["modelValue"])])),_:1}),(0,p.Wm)(g,null,{default:(0,p.w5)((()=>[I,(0,p.Wm)(_,{modelValue:B.value.package_path,"onUpdate:modelValue":c[8]||(c[8]=e=>B.value.package_path=e),autocomplete:"off",style:{width:"200px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])],64)}}},B=l(3744);const R=(0,B.Z)(j,[["__scopeId","data-v-bc5d6c6c"]]);var Y=R}}]);
//# sourceMappingURL=457.9d48ebb7.js.map